import{b as f,a as n,c as p,e as y,f as h,G as w,g as E}from"./firebase-D9Xq9M1Z.js";const i=document.getElementById("login-form"),c=document.getElementById("email"),m=document.getElementById("pw"),a=document.getElementById("login-btn"),r=document.getElementById("signup-btn"),l=document.getElementById("google-btn"),g=document.getElementById("forgot-pw-link");document.getElementById("auth-message");console.log("[Auth] Login script loaded. Form found:",!!i);const s=(e,t=!0)=>{const o=document.getElementById("auth-message");o?(o.textContent=e,o.style.color=t?"#ff4444":"#44ff44",o.style.display="block"):alert(e)},d=()=>{const e=document.getElementById("auth-message");e&&(e.textContent="",e.style.display="none")};f(n,e=>{e&&(console.log("[Auth] User detected:",e.uid,e.isAnonymous?"(Anonymous)":"(Authenticated)"),localStorage.setItem("isAuthenticated","true"),window.location.replace("/"))});g&&g.addEventListener("click",async e=>{e.preventDefault(),d();const t=c?.value.trim();if(!t){s("Please enter your email address first.");return}try{await p(n,t),s(`Password reset email sent to ${t}`,!1)}catch(o){console.error("Password reset error:",o),s(o.message||"Failed to send password reset email")}});i&&(i.addEventListener("submit",async e=>{e.preventDefault(),d();const t=c?.value.trim(),o=m?.value;if(!t||!o){s("Email and password required");return}a&&(a.disabled=!0);try{await y(n,t,o)}catch(u){console.error("Login error:",u),s(u.message||"Failed to login"),a&&(a.disabled=!1)}}),i.dataset.authReady="true");r&&r.addEventListener("click",async()=>{d();const e=c?.value.trim(),t=m?.value;if(!e||!t){s("Email and password required for signup");return}r.disabled=!0;try{await h(n,e,t),s("Account created! Logging in...")}catch(o){console.error("Signup error:",o),s(o.message||"Failed to create account"),r.disabled=!1}});l&&l.addEventListener("click",async()=>{console.log("[Auth] Google button clicked"),d();const e=new w;l.disabled=!0;try{console.log("[Auth] Calling signInWithPopup...");const t=await E(n,e);console.log("[Auth] Google Popup Success:",t.user.uid),s("Login successful! Redirecting...",!1)}catch(t){console.error("Google login error:",t),s(t.message||"Failed to login with Google"),l.disabled=!1}});
