import{o as f,a as s,s as h,b as p,c as y,G as w,d as E}from"./firebase-D4b_x8Xg.js";const l=document.getElementById("login-form"),c=document.getElementById("email"),m=document.getElementById("pw"),a=document.getElementById("login-btn"),r=document.getElementById("signup-btn"),i=document.getElementById("google-btn"),g=document.getElementById("forgot-pw-link");document.getElementById("auth-message");console.log("[Auth] Login script loaded. Form found:",!!l);const n=(e,t=!0)=>{const o=document.getElementById("auth-message");o?(o.textContent=e,o.style.color=t?"#ff4444":"#44ff44",o.style.display="block"):alert(e)},d=()=>{const e=document.getElementById("auth-message");e&&(e.textContent="",e.style.display="none")};f(s,e=>{e&&(console.log("[Auth] User detected:",e.uid,e.isAnonymous?"(Anonymous)":"(Authenticated)"),localStorage.setItem("isAuthenticated","true"),window.location.href="/")});g&&g.addEventListener("click",async e=>{e.preventDefault(),d();const t=c?.value.trim();if(!t){n("Please enter your email address first.");return}try{await h(s,t),n(`Password reset email sent to ${t}`,!1)}catch(o){console.error("Password reset error:",o),n(o.message||"Failed to send password reset email")}});l&&(l.addEventListener("submit",async e=>{e.preventDefault(),d();const t=c?.value.trim(),o=m?.value;if(!t||!o){n("Email and password required");return}a&&(a.disabled=!0);try{await p(s,t,o)}catch(u){console.error("Login error:",u),n(u.message||"Failed to login"),a&&(a.disabled=!1)}}),l.dataset.authReady="true");r&&r.addEventListener("click",async()=>{d();const e=c?.value.trim(),t=m?.value;if(!e||!t){n("Email and password required for signup");return}r.disabled=!0;try{await y(s,e,t),n("Account created! Logging in...")}catch(o){console.error("Signup error:",o),n(o.message||"Failed to create account"),r.disabled=!1}});i&&i.addEventListener("click",async()=>{console.log("[Auth] Google button clicked"),d();const e=new w;i.disabled=!0;try{console.log("[Auth] Calling signInWithPopup..."),await E(s,e),console.log("[Auth] signInWithPopup returned")}catch(t){console.error("Google login error:",t),n(t.message||"Failed to login with Google"),i.disabled=!1}});
