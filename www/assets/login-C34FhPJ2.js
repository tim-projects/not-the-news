import{g as f,b as y,a as n,c as h,e as p,f as w,G as E,h as I}from"./firebase-DmSgnSs_.js";f(n).catch(e=>{console.error("Google Redirect Error:",e),s(e.message||"Failed to complete Google login")});const i=document.getElementById("login-form"),c=document.getElementById("email"),u=document.getElementById("pw"),a=document.getElementById("login-btn"),r=document.getElementById("signup-btn"),l=document.getElementById("google-btn"),m=document.getElementById("forgot-pw-link");document.getElementById("auth-message");console.log("[Auth] Login script loaded. Form found:",!!i);const s=(e,t=!0)=>{const o=document.getElementById("auth-message");o?(o.textContent=e,o.style.color=t?"#ff4444":"#44ff44",o.style.display="block"):alert(e)},d=()=>{const e=document.getElementById("auth-message");e&&(e.textContent="",e.style.display="none")};y(n,e=>{e&&(console.log("[Auth] User detected:",e.uid,e.isAnonymous?"(Anonymous)":"(Authenticated)"),localStorage.setItem("isAuthenticated","true"),window.location.replace("/"))});m&&m.addEventListener("click",async e=>{e.preventDefault(),d();const t=c?.value.trim();if(!t){s("Please enter your email address first.");return}try{await h(n,t),s(`Password reset email sent to ${t}`,!1)}catch(o){console.error("Password reset error:",o),s(o.message||"Failed to send password reset email")}});i&&(i.addEventListener("submit",async e=>{e.preventDefault(),d();const t=c?.value.trim(),o=u?.value;if(!t||!o){s("Email and password required");return}a&&(a.disabled=!0);try{await p(n,t,o)}catch(g){console.error("Login error:",g),s(g.message||"Failed to login"),a&&(a.disabled=!1)}}),i.dataset.authReady="true");r&&r.addEventListener("click",async()=>{d();const e=c?.value.trim(),t=u?.value;if(!e||!t){s("Email and password required for signup");return}r.disabled=!0;try{await w(n,e,t),s("Account created! Logging in...")}catch(o){console.error("Signup error:",o),s(o.message||"Failed to create account"),r.disabled=!1}});l&&l.addEventListener("click",async()=>{console.log("[Auth] Google button clicked"),d();const e=new E;l.disabled=!0;try{console.log("[Auth] Calling signInWithRedirect..."),await I(n,e)}catch(t){console.error("Google login error:",t),s(t.message||"Failed to login with Google"),l.disabled=!1}});
