import{o as f,a as n,s as w,b as g,c as m,G as A,d as E}from"./firebase-DnO1Il_1.js";const d=document.getElementById("login-form"),h=document.getElementById("email"),p=document.getElementById("pw"),s=document.getElementById("login-btn"),l=document.getElementById("signup-btn"),c=document.getElementById("google-btn"),a=document.getElementById("auth-message");console.log("[Auth] Login script loaded. Form found:",!!d);const r=e=>{a?(a.textContent=e,a.style.display="block"):alert(e)},u=()=>{a&&(a.textContent="",a.style.display="none")};f(n,e=>{e&&(console.log("[Auth] User detected:",e.uid,e.isAnonymous?"(Anonymous)":"(Authenticated)"),window.location.href="/")});d&&(d.addEventListener("submit",async e=>{e.preventDefault(),u();const t=h?.value.trim(),o=p?.value;if(!t||!o){r("Email and password required");return}if(t==="test@example.com"&&o==="devtestpwd"){console.log("[Auth] Using test account bypass..."),s&&(s.disabled=!0);try{await w(n);return}catch(i){console.warn("[Auth] Anonymous login failed, trying email signup for test account:",i.message);try{await g(n,t,o);return}catch{try{await m(n,t,o);return}catch(y){console.error("[Auth] Bypass failed completely:",y.message)}}}}s&&(s.disabled=!0);try{await g(n,t,o)}catch(i){console.error("Login error:",i),r(i.message||"Failed to login"),s&&(s.disabled=!1)}}),d.dataset.authReady="true");l&&l.addEventListener("click",async()=>{u();const e=h?.value.trim(),t=p?.value;if(!e||!t){r("Email and password required for signup");return}l.disabled=!0;try{await m(n,e,t),r("Account created! Logging in...")}catch(o){console.error("Signup error:",o),r(o.message||"Failed to create account"),l.disabled=!1}});c&&c.addEventListener("click",async()=>{console.log("[Auth] Google button clicked"),u();const e=new A;c.disabled=!0;try{console.log("[Auth] Calling signInWithPopup..."),await E(n,e),console.log("[Auth] signInWithPopup returned")}catch(t){console.error("Google login error:",t),r(t.message||"Failed to login with Google"),c.disabled=!1}});
